---
title: 'Allegro 输出生产数据详解'
date: Mon, 17 May 2021 10:33:14 +0000
draft: false
tags: ['Allegro']
---

说明
--

用于PCB裸板的生产可以分别单独创建文件 光绘数据（Gerber）、钻孔（NC Drill）、IPC网表；或者通过ODB++或IPC2581文件（这是一个新格式），它包含生产裸板所需要的所有信息

光绘数据 Artwork Gerber
-------------------

光绘数据一般包含设计中各个层面的蚀刻线路、阻焊、铅锡、字符等信息用于PCB裸板除钻孔外的所有生产信息。

光绘数据包括几种格式，其中较旧的格式要求创建一个aperture list与光绘数据一起提供，现在常用的图样格式为RS274X它是包含aperture data的因此不需要单独输出此文件，本文基于此种格式进行介绍

### 光绘层设置

输出光绘数据需要定义光绘底片需要包含的图形信息，从菜单Manufacture > Artwork命令，进入Artwork Control Form的Films Control标签进行设置，一般第一次打开此界面时，软件会根据设计的层叠信息正负片信息自动创建各个布线层对应侧层叠信息用于制作PCB各层的线路（如果设计层叠有修改，需要手动调整这些层面），这些层包含各个层面对应的ETCH、PIN、VIA，生产PCB所需的其它图形需要我们手动添加如丝印、阻焊、铅锡等

![](http://a1024.synology.me:222/images/blog2022/artwork1.png)

一般层面的添加通过三种方式，当然也可以通过skill实现，本文不做介绍

#### 从显示层面添加

使用Display > Color Visibility菜单（或其它方式）调整显示的层，使显示的层为且仅为光绘所需的层，在Films Control右键选择Add，然后为此层指定一个可识别的名称，则一个Artwork设置完毕，按照此方法继续添加下一个Artwork

#### 手动添加

在Films Control右键选择Add Manual，然后为此层指定一个可识别的名称，将跳出设计中的Class/Sub Class，通过在对应侧层前的多选框选择所需层面，则一个Artwork设置完毕，按照此方法继续添加下一个Artwork

#### 从模版添加

添加的层叠可以存为模版，并在下一次使用时调用，通过勾选择需要定义为模版的Artwork，右键选择Save All Checked，将在Brd所在目录生成一个FILM\_SETUP.txt文件，保存这个文件，并在下次使用时通过Artwork层叠对话框下方的Add选择此文件，此模版文件将被再次调用，此[链接](http://a1024.synology.me:222/images/blog2022/FILM_SETUP.txt)为我的常用模版，包括丝印阻焊和铅锡层（使用另存为保存），可参考使用。模版的设置包含一个Undefined Line Width值（见下文）与设计精度关联，调用模版时需注意此值

除层叠设置外Artwork还有一些常用的其它选项如下

*   **Available Films**：用于层叠的设置见上文
*   **Select All：**选择所有Artwork
*   **Add：**选择模版添加Artwork
*   **Replace**：使用模版替换已添加的Artwork
*   **Check Database Before Artwork：**选中此选项则在生成Artwork前进行数据库完整性检查，如果发现错误则Artwork不会被生成
*   **Create Artwork：**为选择的Artwork层创建光绘数据，输出数据后会弹窗报告，请查看报告内容尤其是错误

右侧的几个选项一般保持默认即可，可以主要关注以下几个选项

*   **Undefined Line Width：**将光绘层中0线宽的对象指定一个线宽值，否则0线宽（包含非填充的shape图形如outline层的shape板框）的对象将不会被输出，如果使用了上述模版需注意此值，此值在模版中被引用的值与设计精度关联。
*   **Shape Bounding Box：**适用于负片，我没理解这个，等我再理解理解
*   **Plot mode：**选择正片或负片，与设计一致，一般只有铺铜平面层使用负片时这里选择负片，其它均为正片，软件自动创建的层这里将与设计层属性一致
*   **Suppress Unconnected Pads ：**仅适用于正片（负片默认就是勾选效果），勾选代表没有连接的孔盘将不被做出（非功能性焊盘不作出），前提是设计中已启用了unconnected internal pads此选项才有效，不勾选时非功能性焊盘将做出，请按需设置

**General Parameters Tab**

*   **Device Type：**光绘格式选择Gerber RS274X
*   **Format：**指定数据中的坐标位数的整数位数和小数位数，上面是整数，下面是小数
*   其他设置均按默认

按需设置完上述选项，选择需要输出的Artwork层叠，选择**Create Artwork**按钮则在brd所在路径或指定的路径生成对应的光绘设计文件，默认后缀为art

钻孔数据 NC Drill
-------------

用于创建PCB的钻孔文件，这些文件列出了适合直接使用的钻孔类型和坐标位置。大多数Gerber查看器会读取NC钻孔文件，并在正确的位置显示钻孔。使用Manufacture > NC > NC Drill输出此文件。

![](http://a1024.synology.me:222/images/blog2022/NCdrill.png)

此面板多数参数均保持默认即可，如有特殊要求可按需设置，一般也就NC Parameters中的Format（和上文Artwork解读一致）可能有要求；Separate Files for Plated/Non-plated holes选择此项将分别输出金属化孔和非金属化孔为两个文件；需要背钻需选择Include Backdrill以及其它背钻需要的设置(本文不介绍)

设置好参数后单击Drill按钮即在brd所在路径或指定位置生成钻孔文件后缀为drl

NC Route (按需)
-------------

如果设计使用了槽形孔，或使用了Cutout定义板框，那么这部分信息是不被包含在NC Drill文件中的，此时可以使用输出NC Route文件来定义此部分信息（当然只要你愿意你可以用其它方式，只要能将此信息传递给生产方即可），如果没有槽形孔或Cutout则无需输出此文件

从菜单Manufacture > NC > NC Route输出此文件，和NC Drill一样，多数参数均保持默认即可，如有特殊要求可按需设置，一般也就NC Parameters中的Format（和上文Artwork解读一致）可能有要求

设置好参数后单击route按钮即在brd所在路径或指定位置生成钻孔文件后缀为rou

IPC Netlist
-----------

建议你在向PCB制造商发送Gerber和钻孔文件时，同时发送IPC 356网表。通常情况下，如果你不这样做，制造商会根据收到的Gerber文件创建一个网表。这样做的最大问题是，如果你的Gerber数据不正确，完成的裸板测试的网表也会有这些错误。通过发送独立的IPC 356网表，意味着如果Gerber数据有任何问题，这些问题将在制造过程的早期被标记出来，因为制造商可以检查Gerber数据和网表。

使用菜单File > Export > IPC 356..菜单输出此文件，注意编写此处文件名时注意不要有小数点，否则程序将不能正确的添加文件名后缀为ipc，参数一般不用设置，直接输出就好，IPC-D-365A较IPC-D-356新增对于盲埋孔的支持，如果有埋盲孔请选择IPC-D-365A格式，其它均无区别

ODB++ Data
----------

许多PCB制造商将可以接受ODB++数据，但目前仍为流行，它包含了所有相关的制造数据组合。用户仍然需要定义artwork和正确的钻孔尺寸，使用File > Export > ODB++ Inside导出此数据，使用此功能需要从Mentor官方先安装插件，详细参数待后续补充

IPC2581
-------

在过去的三十年里，PCB已经发生了很大的变化，但我们仍然普遍使用30年前的方式将设计意图传达给制造业。这些几十年前的数据通信格式，最初是为了驱动新兴的数控机床而设想的。正确实施的Gerber格式完全可以用来传输图像数据，但它不能传输堆叠数据、材料、设计意图或网表。IPC这个贸易团体已经意识到了PCB设计和制造领域的挑战和动态，并一直热衷于倡导取代这些旧的数据通信格式。

该项目是一个全行业的项目，旨在定义最终的数据交换融合规范。其目的是使印制电路板（PCB）和装配体的设计者和制造商之间能够使用单一的基于XLM的数据交换格式进行准确、高效的数据交换。通过这一努力，IPC委员会制定了一个新的标准，IPC-2581，印制板组装产品制造描述数据和传输方法的通用要求；它于2004年3月发布。有了IPC-2581，行业终于有了一个全球性的机会，通过实施标准化的安全和完整的设计数据传输，节省了数以百万计的因管理不同格式的多个文件而浪费的成本。但是，就像数据格式规范一样，如果各个流程不使用它，它将没有任何意义。这就是一个由PCB设计软件（EDA）和供应链公司组成的新联盟的作用：将各公司聚集在一起，以实现、促进和推动IPC-2581的使用。

使用菜单File > Export > IPC2581导出此数据，详细参数待后续补充

![](http://a1024.synology.me:222/images/blog2022/output_data.jpg)